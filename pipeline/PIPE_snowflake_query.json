{
	"name": "PIPE_snowflake_query",
	"properties": {
		"activities": [
			{
				"name": "Script1",
				"type": "Script",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "adfadbplt001lssnfkpltdnacore",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "create or replace view ASPEDW_ACCESS.EDW_RPT_REGIONAL_SELLOUT_OFFTAKE as (\r\nselect\r\n    year AS \"year\",\r\n    qrtr_no AS \"qrtr_no\",\r\n    mnth_id AS \"mnth_id\",\r\n    mnth_no AS \"mnth_no\",\r\n    cal_date AS \"cal_date\",\r\n    week_start_date AS \"week_start_date\",\r\n    univ_year AS \"univ_year\",\r\n    univ_month AS \"univ_month\",\r\n    country_code AS \"country_code\",\r\n    country_name AS \"country_name\",\r\n    data_source AS \"data_source\",\r\n    soldto_code AS \"soldto_code\",\r\n    distributor_code AS \"distributor_code\",\r\n    distributor_name AS \"distributor_name\",\r\n    store_code AS \"store_code\",\r\n    store_name AS \"store_name\",\r\n    store_type AS \"store_type\",\r\n    distributor_additional_attribute1 AS \"distributor_additional_attribute1\",\r\n    distributor_additional_attribute2 AS \"distributor_additional_attribute2\",\r\n    distributor_additional_attribute3 AS \"distributor_additional_attribute3\",\r\n    sap_parent_customer_key AS \"sap_parent_customer_key\",\r\n    sap_parent_customer_description AS \"sap_parent_customer_description\",\r\n    sap_customer_channel_key AS \"sap_customer_channel_key\",\r\n    sap_customer_channel_description AS \"sap_customer_channel_description\",\r\n    sap_customer_sub_channel_key AS \"sap_customer_sub_channel_key\",\r\n    sap_sub_channel_description AS \"sap_sub_channel_description\",\r\n    sap_go_to_mdl_key AS \"sap_go_to_mdl_key\",\r\n    sap_go_to_mdl_description AS \"sap_go_to_mdl_description\",\r\n    sap_banner_key AS \"sap_banner_key\",\r\n    sap_banner_description AS \"sap_banner_description\",\r\n    sap_banner_format_key AS \"sap_banner_format_key\",\r\n    sap_banner_format_description AS \"sap_banner_format_description\",\r\n    retail_environment AS \"retail_environment\",\r\n    region AS \"region\",\r\n    zone_or_area AS \"zone_or_area\",\r\n    customer_segment_key AS \"customer_segment_key\",\r\n    customer_segment_description AS \"customer_segment_description\",\r\n    global_product_franchise AS \"global_product_franchise\",\r\n    global_product_brand AS \"global_product_brand\",\r\n    global_product_sub_brand AS \"global_product_sub_brand\",\r\n    global_product_variant AS \"global_product_variant\",\r\n    global_product_segment AS \"global_product_segment\",\r\n    global_product_subsegment AS \"global_product_subsegment\",\r\n    global_product_category AS \"global_product_category\",\r\n    global_product_subcategory AS \"global_product_subcategory\",\r\n    global_put_up_description AS \"global_put_up_description\",\r\n    ean AS \"ean\",\r\n    sku_code AS \"sku_code\",\r\n    sku_description AS \"sku_description\",\r\n    pka_product_key AS \"pka_product_key\",\r\n    pka_product_key_description AS \"pka_product_key_description\",\r\n    from_currency AS \"from_currency\",\r\n    to_currency AS \"to_currency\",\r\n    exchange_rate AS \"exchange_rate\",\r\n    sellout_sales_quantity AS \"sellout_sales_quantity\",\r\n    sellout_sales_value AS \"sellout_sales_value\",\r\n    sellout_sales_value_usd AS \"sellout_sales_value_usd\",\r\n    list_price AS \"list_price\",\r\n    sellout_value_list_price AS \"sellout_value_list_price\",\r\n    sellout_value_list_price_usd AS \"sellout_value_list_price_usd\",\r\n    selling_price AS \"selling_price\",\r\n    first_scan_flag_parent_customer_level AS \"first_scan_flag_parent_customer_level\",\r\n    first_scan_flag_market_level AS \"first_scan_flag_market_level\",\r\n    npd_flag_market_level AS \"npd_flag_market_level\",\r\n    npd_flag_parent_customer_level AS \"npd_flag_parent_customer_level\",\r\n    customer_product_desc AS \"customer_product_desc\",\r\n\tmsl_product_code AS \"msl_product_code\",\r\n\tmsl_product_desc AS \"msl_product_desc\",\r\n\tstore_grade AS \"store_grade\",\r\n\tretail_env AS \"retail_env\",\r\n\tchannel AS \"channel\",\r\n    crtd_dttm AS \"crtd_dttm\",\r\n    updt_dttm AS \"updt_dttm\", \r\nTO_DATE(CONCAT(univ_year, '-', LPAD(univ_month, 2, '0'), '-01')) AS \"universal calendar\",\r\nTO_DATE(CONCAT(year, '-', LPAD(mnth_no, 2, '0'), '-01')) AS \"jnj calendar\"\r\nfrom ASPEDW_INTEGRATION.EDW_RPT_REGIONAL_SELLOUT_OFFTAKE \r\nwhere year>=(SELECT MIN(result)\r\nFROM (\r\n    SELECT\r\n        GREATEST(MAX(year) - 2, MAX(univ_year) - 2) AS result\r\n    FROM\r\n        ASPEDW_INTEGRATION.EDW_RPT_REGIONAL_SELLOUT_OFFTAKE \r\n)));"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			}
		],
		"variables": {
			"countQueryRedshift": {
				"type": "String"
			},
			"countQuerySnowflake": {
				"type": "String"
			}
		},
		"folder": {
			"name": "Historical_Data_migration_redshift_snowflake"
		},
		"annotations": []
	}
}