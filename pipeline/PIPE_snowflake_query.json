{
	"name": "PIPE_snowflake_query",
	"properties": {
		"activities": [
			{
				"name": "Script1",
				"type": "Script",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "adfadbplt001lssnfkpltdnacore",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "create or replace TABLE ASPEDW_INTEGRATION.EDW_RPT_REGIONAL_SELLOUT_OFFTAKE (\r\n\tYEAR NUMBER(18,0),\r\n\tQRTR_NO VARCHAR(14),\r\n\tMNTH_ID VARCHAR(23),\r\n\tMNTH_NO NUMBER(18,0),\r\n\tCAL_DATE DATE,\r\n\tWEEK_START_DATE DATE,\r\n\tUNIV_YEAR NUMBER(18,0),\r\n\tUNIV_MONTH NUMBER(18,0),\r\n\tCOUNTRY_CODE VARCHAR(2),\r\n\tCOUNTRY_NAME VARCHAR(50),\r\n\tDATA_SOURCE VARCHAR(14),\r\n\tSOLDTO_CODE VARCHAR(255),\r\n\tDISTRIBUTOR_CODE VARCHAR(100),\r\n\tDISTRIBUTOR_NAME VARCHAR(255),\r\n\tSTORE_CODE VARCHAR(100),\r\n\tSTORE_NAME VARCHAR(500),\r\n\tSTORE_TYPE VARCHAR(255),\r\n\tDISTRIBUTOR_ADDITIONAL_ATTRIBUTE1 VARCHAR(150),\r\n\tDISTRIBUTOR_ADDITIONAL_ATTRIBUTE2 VARCHAR(150),\r\n\tDISTRIBUTOR_ADDITIONAL_ATTRIBUTE3 VARCHAR(150),\r\n\tSAP_PARENT_CUSTOMER_KEY VARCHAR(12),\r\n\tSAP_PARENT_CUSTOMER_DESCRIPTION VARCHAR(75),\r\n\tSAP_CUSTOMER_CHANNEL_KEY VARCHAR(12),\r\n\tSAP_CUSTOMER_CHANNEL_DESCRIPTION VARCHAR(75),\r\n\tSAP_CUSTOMER_SUB_CHANNEL_KEY VARCHAR(12),\r\n\tSAP_SUB_CHANNEL_DESCRIPTION VARCHAR(75),\r\n\tSAP_GO_TO_MDL_KEY VARCHAR(12),\r\n\tSAP_GO_TO_MDL_DESCRIPTION VARCHAR(75),\r\n\tSAP_BANNER_KEY VARCHAR(12),\r\n\tSAP_BANNER_DESCRIPTION VARCHAR(75),\r\n\tSAP_BANNER_FORMAT_KEY VARCHAR(12),\r\n\tSAP_BANNER_FORMAT_DESCRIPTION VARCHAR(75),\r\n\tRETAIL_ENVIRONMENT VARCHAR(50),\r\n\tREGION VARCHAR(150),\r\n\tZONE_OR_AREA VARCHAR(150),\r\n\tCUSTOMER_SEGMENT_KEY VARCHAR(12),\r\n\tCUSTOMER_SEGMENT_DESCRIPTION VARCHAR(50),\r\n\tGLOBAL_PRODUCT_FRANCHISE VARCHAR(30),\r\n\tGLOBAL_PRODUCT_BRAND VARCHAR(30),\r\n\tGLOBAL_PRODUCT_SUB_BRAND VARCHAR(100),\r\n\tGLOBAL_PRODUCT_VARIANT VARCHAR(100),\r\n\tGLOBAL_PRODUCT_SEGMENT VARCHAR(50),\r\n\tGLOBAL_PRODUCT_SUBSEGMENT VARCHAR(100),\r\n\tGLOBAL_PRODUCT_CATEGORY VARCHAR(50),\r\n\tGLOBAL_PRODUCT_SUBCATEGORY VARCHAR(50),\r\n\tGLOBAL_PUT_UP_DESCRIPTION VARCHAR(100),\r\n\tEAN VARCHAR(50),\r\n\tSKU_CODE VARCHAR(40),\r\n\tSKU_DESCRIPTION VARCHAR(150),\r\n\tPKA_PRODUCT_KEY VARCHAR(68),\r\n\tPKA_PRODUCT_KEY_DESCRIPTION VARCHAR(255),\r\n\tFROM_CURRENCY VARCHAR(5),\r\n\tTO_CURRENCY VARCHAR(5),\r\n\tEXCHANGE_RATE NUMBER(15,5),\r\n\tSELLOUT_SALES_QUANTITY NUMBER(38,6),\r\n\tSELLOUT_SALES_VALUE NUMBER(38,6),\r\n\tSELLOUT_SALES_VALUE_USD NUMBER(38,11),\r\n\tLIST_PRICE NUMBER(38,6),\r\n\tSELLOUT_VALUE_LIST_PRICE NUMBER(38,12),\r\n\tSELLOUT_VALUE_LIST_PRICE_USD NUMBER(38,17),\r\n\tSELLING_PRICE NUMBER(38,4),\r\n\tFIRST_SCAN_FLAG_PARENT_CUSTOMER_LEVEL VARCHAR(1),\r\n\tFIRST_SCAN_FLAG_MARKET_LEVEL VARCHAR(1),\r\n\tNPD_FLAG_MARKET_LEVEL VARCHAR(1),\r\n\tNPD_FLAG_PARENT_CUSTOMER_LEVEL VARCHAR(1),\r\n\tCUSTOMER_PRODUCT_DESC VARCHAR(300),\r\n\tMSL_PRODUCT_CODE VARCHAR(150),\r\n\tMSL_PRODUCT_DESC VARCHAR(300),\r\n\tSTORE_GRADE VARCHAR(150),\r\n\tRETAIL_ENV VARCHAR(150),\r\n\tCHANNEL VARCHAR(150),\r\n\tCRTD_DTTM TIMESTAMP_NTZ(9),\r\n\tUPDT_DTTM TIMESTAMP_NTZ(9)\r\n);\r\n\r\ncreate or replace view ASPEDW_ACCESS.EDW_RPT_REGIONAL_SELLOUT_OFFTAKE as\r\nSELECT\r\n    year AS \"year\",\r\n    qrtr_no AS \"qrtr_no\",\r\n    mnth_id AS \"mnth_id\",\r\n    mnth_no AS \"mnth_no\",\r\n    cal_date AS \"cal_date\",\r\n    week_start_date AS \"week_start_date\",\r\n    univ_year AS \"univ_year\",\r\n    univ_month AS \"univ_month\",\r\n    country_code AS \"country_code\",\r\n    country_name AS \"country_name\",\r\n    data_source AS \"data_source\",\r\n    soldto_code AS \"soldto_code\",\r\n    distributor_code AS \"distributor_code\",\r\n    distributor_name AS \"distributor_name\",\r\n    store_code AS \"store_code\",\r\n    store_name AS \"store_name\",\r\n    store_type AS \"store_type\",\r\n    distributor_additional_attribute1 AS \"distributor_additional_attribute1\",\r\n    distributor_additional_attribute2 AS \"distributor_additional_attribute2\",\r\n    distributor_additional_attribute3 AS \"distributor_additional_attribute3\",\r\n    sap_parent_customer_key AS \"sap_parent_customer_key\",\r\n    sap_parent_customer_description AS \"sap_parent_customer_description\",\r\n    sap_customer_channel_key AS \"sap_customer_channel_key\",\r\n    sap_customer_channel_description AS \"sap_customer_channel_description\",\r\n    sap_customer_sub_channel_key AS \"sap_customer_sub_channel_key\",\r\n    sap_sub_channel_description AS \"sap_sub_channel_description\",\r\n    sap_go_to_mdl_key AS \"sap_go_to_mdl_key\",\r\n    sap_go_to_mdl_description AS \"sap_go_to_mdl_description\",\r\n    sap_banner_key AS \"sap_banner_key\",\r\n    sap_banner_description AS \"sap_banner_description\",\r\n    sap_banner_format_key AS \"sap_banner_format_key\",\r\n    sap_banner_format_description AS \"sap_banner_format_description\",\r\n    retail_environment AS \"retail_environment\",\r\n    region AS \"region\",\r\n    zone_or_area AS \"zone_or_area\",\r\n    customer_segment_key AS \"customer_segment_key\",\r\n    customer_segment_description AS \"customer_segment_description\",\r\n    global_product_franchise AS \"global_product_franchise\",\r\n    global_product_brand AS \"global_product_brand\",\r\n    global_product_sub_brand AS \"global_product_sub_brand\",\r\n    global_product_variant AS \"global_product_variant\",\r\n    global_product_segment AS \"global_product_segment\",\r\n    global_product_subsegment AS \"global_product_subsegment\",\r\n    global_product_category AS \"global_product_category\",\r\n    global_product_subcategory AS \"global_product_subcategory\",\r\n    global_put_up_description AS \"global_put_up_description\",\r\n    ean AS \"ean\",\r\n    sku_code AS \"sku_code\",\r\n    sku_description AS \"sku_description\",\r\n    pka_product_key AS \"pka_product_key\",\r\n    pka_product_key_description AS \"pka_product_key_description\",\r\n    from_currency AS \"from_currency\",\r\n    to_currency AS \"to_currency\",\r\n    exchange_rate AS \"exchange_rate\",\r\n    sellout_sales_quantity AS \"sellout_sales_quantity\",\r\n    sellout_sales_value AS \"sellout_sales_value\",\r\n    sellout_sales_value_usd AS \"sellout_sales_value_usd\",\r\n    list_price AS \"list_price\",\r\n    sellout_value_list_price AS \"sellout_value_list_price\",\r\n    sellout_value_list_price_usd AS \"sellout_value_list_price_usd\",\r\n    selling_price AS \"selling_price\",\r\n    first_scan_flag_parent_customer_level AS \"first_scan_flag_parent_customer_level\",\r\n    first_scan_flag_market_level AS \"first_scan_flag_market_level\",\r\n    npd_flag_market_level AS \"npd_flag_market_level\",\r\n    npd_flag_parent_customer_level AS \"npd_flag_parent_customer_level\",\r\n    customer_product_desc AS \"customer_product_desc\",\r\n\tmsl_product_code AS \"msl_product_code\",\r\n\tmsl_product_desc AS \"msl_product_desc\",\r\n\tstore_grade AS \"store_grade\",\r\n\tretail_env AS \"retail_env\",\r\n\tchannel AS \"channel\",\r\n    crtd_dttm AS \"crtd_dttm\",\r\n    updt_dttm AS \"updt_dttm\",\r\n    TO_DATE(CONCAT(univ_year, '-', LPAD(univ_month, 2, '0'), '-01')) AS \"universal calendar\",\r\n    TO_DATE(CONCAT(year, '-', LPAD(mnth_no, 2, '0'), '-01')) AS \"jnj calendar\",\r\n    LEAST(DATEADD('YEAR', -2, GREATEST(TO_DATE(CONCAT(univ_year, '-', LPAD(univ_month, 2, '0'), '-01')), TO_DATE(CONCAT(year, '-', LPAD(mnth_no, 2, '0'), '-01')))), \r\n          DATEADD('YEAR', -2, GREATEST(TO_DATE(CONCAT(univ_year, '-', LPAD(univ_month, 2, '0'), '-01')), TO_DATE(CONCAT(year, '-', LPAD(mnth_no, 2, '0'), '-01'))))) AS \"min date\"\r\nFROM ASPEDW_INTEGRATION.EDW_RPT_REGIONAL_SELLOUT_OFFTAKE;"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			}
		],
		"variables": {
			"countQueryRedshift": {
				"type": "String"
			},
			"countQuerySnowflake": {
				"type": "String"
			}
		},
		"folder": {
			"name": "Historical_Data_migration_redshift_snowflake"
		},
		"annotations": []
	}
}