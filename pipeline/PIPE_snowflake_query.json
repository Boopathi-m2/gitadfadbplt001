{
	"name": "PIPE_snowflake_query",
	"properties": {
		"activities": [
			{
				"name": "Script1",
				"type": "Script",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "adfadbplt001lssnfkpltdnacore",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "CREATE OR REPLACE VIEW DEV_DNA_CORE.MYSEDW_ACCESS.EDW_MY_SIPOS_ANALYSIS AS\r\nSELECT\r\n    DATA_SRC AS \"data_src\",\r\n    JJ_YEAR AS \"jj_year\",\r\n    JJ_QTR AS \"jj_qtr\",\r\n    JJ_MNTH_ID AS \"jj_mnth_id\",\r\n    JJ_MNTH_NO AS \"jj_mnth_no\",\r\n    JJ_YEAR_WK_NO AS \"jj_year_wk_no\",\r\n    CNTRY_NM AS \"cntry_nm\",\r\n    CUST_CD AS \"cust_cd\",\r\n    CUST_BRNCH_CD AS \"cust_brnch_cd\",\r\n    MT_CUST_BRNCH_NM AS \"mt_cust_brnch_nm\",\r\n    CUST_DEPT_CD AS \"cust_dept_cd\",\r\n    MT_CUST_DEPT_NM AS \"mt_cust_dept_nm\",\r\n    REGION_CD AS \"region_cd\",\r\n    REGION_NM AS \"region_nm\",\r\n    ITEM_CD AS \"item_cd\",\r\n    MT_ITEM_NM AS \"mt_item_nm\",\r\n    SOLD_TO AS \"sold_to\",\r\n    SOLD_TO_NM AS \"sold_to_nm\",\r\n    TRADE_TYPE AS \"trade_type\",\r\n    DSTRBTR_GRP_CD AS \"dstrbtr_grp_cd\",\r\n    DSTRBTR_GRP_NM AS \"dstrbtr_grp_nm\",\r\n    SAP_STATE_CD AS \"sap_state_cd\",\r\n    SAP_SLS_ORG AS \"sap_sls_org\",\r\n    SAP_CMP_ID AS \"sap_cmp_id\",\r\n    SAP_CNTRY_CD AS \"sap_cntry_cd\",\r\n    SAP_CNTRY_NM AS \"sap_cntry_nm\",\r\n    SAP_ADDR AS \"sap_addr\",\r\n    SAP_REGION AS \"sap_region\",\r\n    SAP_CITY AS \"sap_city\",\r\n    SAP_POST_CD AS \"sap_post_cd\",\r\n    SAP_CHNL_CD AS \"sap_chnl_cd\",\r\n    SAP_CHNL_DESC AS \"sap_chnl_desc\",\r\n    SAP_SLS_OFFICE_CD AS \"sap_sls_office_cd\",\r\n    SAP_SLS_OFFICE_DESC AS \"sap_sls_office_desc\",\r\n    SAP_SLS_GRP_CD AS \"sap_sls_grp_cd\",\r\n    SAP_SLS_GRP_DESC AS \"sap_sls_grp_desc\",\r\n    SAP_CURR_CD AS \"sap_curr_cd\",\r\n    GCH_REGION AS \"gch_region\",\r\n    GCH_CLUSTER AS \"gch_cluster\",\r\n    GCH_SUBCLUSTER AS \"gch_subcluster\",\r\n    GCH_MARKET AS \"gch_market\",\r\n    GCH_RETAIL_BANNER AS \"gch_retail_banner\",\r\n    SKU AS \"sku\",\r\n    FRNCHSE_DESC AS \"frnchse_desc\",\r\n    BRND_DESC AS \"brnd_desc\",\r\n    VRNT_DESC AS \"vrnt_desc\",\r\n    PUTUP_DESC AS \"putup_desc\",\r\n    ITEM_DESC2 AS \"item_desc2\",\r\n    SKU_DESC AS \"sku_desc\",\r\n    SAP_MAT_TYPE_CD AS \"sap_mat_type_cd\",\r\n    SAP_MAT_TYPE_DESC AS \"sap_mat_type_desc\",\r\n    SAP_BASE_UOM_CD AS \"sap_base_uom_cd\",\r\n    SAP_PRCHSE_UOM_CD AS \"sap_prchse_uom_cd\",\r\n    SAP_PROD_SGMT_CD AS \"sap_prod_sgmt_cd\",\r\n    SAP_PROD_SGMT_DESC AS \"sap_prod_sgmt_desc\",\r\n    SAP_BASE_PROD_CD AS \"sap_base_prod_cd\",\r\n    SAP_BASE_PROD_DESC AS \"sap_base_prod_desc\",\r\n    SAP_MEGA_BRND_CD AS \"sap_mega_brnd_cd\",\r\n    SAP_MEGA_BRND_DESC AS \"sap_mega_brnd_desc\",\r\n    SAP_BRND_CD AS \"sap_brnd_cd\",\r\n    SAP_BRND_DESC AS \"sap_brnd_desc\",\r\n    SAP_VRNT_CD AS \"sap_vrnt_cd\",\r\n    SAP_VRNT_DESC AS \"sap_vrnt_desc\",\r\n    SAP_PUT_UP_CD AS \"sap_put_up_cd\",\r\n    SAP_PUT_UP_DESC AS \"sap_put_up_desc\",\r\n    SAP_GRP_FRNCHSE_CD AS \"sap_grp_frnchse_cd\",\r\n    SAP_GRP_FRNCHSE_DESC AS \"sap_grp_frnchse_desc\",\r\n    SAP_FRNCHSE_CD AS \"sap_frnchse_cd\",\r\n    SAP_FRNCHSE_DESC AS \"sap_frnchse_desc\",\r\n    SAP_PROD_FRNCHSE_CD AS \"sap_prod_frnchse_cd\",\r\n    SAP_PROD_FRNCHSE_DESC AS \"sap_prod_frnchse_desc\",\r\n    SAP_PROD_MJR_CD AS \"sap_prod_mjr_cd\",\r\n    SAP_PROD_MJR_DESC AS \"sap_prod_mjr_desc\",\r\n    SAP_PROD_MNR_CD AS \"sap_prod_mnr_cd\",\r\n    SAP_PROD_MNR_DESC AS \"sap_prod_mnr_desc\",\r\n    SAP_PROD_HIER_CD AS \"sap_prod_hier_cd\",\r\n    SAP_PROD_HIER_DESC AS \"sap_prod_hier_desc\",\r\n    GLOBAL_MAT_REGION AS \"global_mat_region\",\r\n    GLOBAL_PROD_FRANCHISE AS \"global_prod_franchise\",\r\n    GLOBAL_PROD_BRAND AS \"global_prod_brand\",\r\n    GLOBAL_PROD_VARIANT AS \"global_prod_variant\",\r\n    GLOBAL_PROD_PUT_UP_CD AS \"global_prod_put_up_cd\",\r\n    GLOBAL_PUT_UP_DESC AS \"global_put_up_desc\",\r\n    GLOBAL_PROD_SUB_BRAND AS \"global_prod_sub_brand\",\r\n    GLOBAL_PROD_NEED_STATE AS \"global_prod_need_state\",\r\n    GLOBAL_PROD_CATEGORY AS \"global_prod_category\",\r\n    GLOBAL_PROD_SUBCATEGORY AS \"global_prod_subcategory\",\r\n    GLOBAL_PROD_SEGMENT AS \"global_prod_segment\",\r\n    GLOBAL_PROD_SUBSEGMENT AS \"global_prod_subsegment\",\r\n    GLOBAL_PROD_SIZE AS \"global_prod_size\",\r\n    GLOBAL_PROD_SIZE_UOM AS \"global_prod_size_uom\",\r\n    FROM_CCY AS \"from_ccy\",\r\n    TO_CCY AS \"to_ccy\",\r\n    EXCH_RATE AS \"exch_rate\",\r\n    BILL_TYPE AS \"bill_type\",\r\n    BILL_QTY_PC AS \"bill_qty_pc\",\r\n    BILLING_GRS_TRD_SLS AS \"billing_grs_trd_sls\",\r\n    BILLING_SUBTOT2 AS \"billing_subtot2\",\r\n    BILLING_SUBTOT3 AS \"billing_subtot3\",\r\n    BILLING_SUBTOT4 AS \"billing_subtot4\",\r\n    BILLING_NET_AMT AS \"billing_net_amt\",\r\n    BILLING_EST_NTS AS \"billing_est_nts\",\r\n    BILLING_INVOICE_VAL AS \"billing_invoice_val\",\r\n    BILLING_GROSS_VAL AS \"billing_gross_val\",\r\n    POS_QTY AS \"pos_qty\",\r\n    POS_GTS AS \"pos_gts\",\r\n    POS_ITEM_PRC AS \"pos_item_prc\",\r\n    POS_TAX AS \"pos_tax\",\r\n    POS_NTS AS \"pos_nts\",\r\n    CONV_FACTOR AS \"conv_factor\",\r\n    JJ_POS_QTY_PC AS \"jj_pos_qty_pc\",\r\n    JJ_POS_ITEM_PRC_PER_PC AS \"jj_pos_item_prc_per_pc\",\r\n    JJ_POS_GTS AS \"jj_pos_gts\",\r\n    JJ_POS_VAT_AMT AS \"jj_pos_vat_amt\",\r\n    JJ_POS_NTS AS \"jj_pos_nts\",\r\n    IS_NPI AS \"is_npi\",\r\n    NPI_STR_PERIOD AS \"npi_str_period\",\r\n    NPI_END_PERIOD AS \"npi_end_period\",\r\n    IS_REG AS \"is_reg\",\r\n    IS_PROMO AS \"is_promo\",\r\n    PROMO_STRT_PERIOD AS \"promo_strt_period\",\r\n    PROMO_END_PERIOD AS \"promo_end_period\",\r\n    IS_MCL AS \"is_mcl\",\r\n    IS_HERO AS \"is_hero\"\r\nFROM DEV_DNA_CORE.MYSEDW_INTEGRATION.EDW_MY_SIPOS_ANALYSIS;\r\n\r\nCREATE OR REPLACE VIEW DEV_DNA_CORE.MYSEDW_ACCESS.EDW_MY_SISO_ANALYSIS AS\r\nSELECT\r\n    DATA_SRC AS \"data_src\",\r\n    YEAR AS \"year\",\r\n    QRTR_NO AS \"qrtr_no\",\r\n    MNTH_ID AS \"mnth_id\",\r\n    MNTH_NO AS \"mnth_no\",\r\n    MNTH_NM AS \"mnth_nm\",\r\n    MAX_YEARMO AS \"max_yearmo\",\r\n    CNTRY_NM AS \"cntry_nm\",\r\n    DSTRBTR_GRP_CD AS \"dstrbtr_grp_cd\",\r\n    DSTRBTR_GRP_NM AS \"dstrbtr_grp_nm\",\r\n    DSTRBTR_CUST_CD AS \"dstrbtr_cust_cd\",\r\n    DSTRBTR_CUST_NM AS \"dstrbtr_cust_nm\",\r\n    SAP_SOLDTO_CODE AS \"sap_soldto_code\",\r\n    SAP_SOLDTO_NM AS \"sap_soldto_nm\",\r\n    DSTRBTR_LVL1 AS \"dstrbtr_lvl1\",\r\n    DSTRBTR_LVL2 AS \"dstrbtr_lvl2\",\r\n    DSTRBTR_LVL3 AS \"dstrbtr_lvl3\",\r\n    DSTRBTR_LVL4 AS \"dstrbtr_lvl4\",\r\n    DSTRBTR_LVL5 AS \"dstrbtr_lvl5\",\r\n    REGION_NM AS \"region_nm\",\r\n    TOWN_NM AS \"town_nm\",\r\n    SLSMN_CD AS \"slsmn_cd\",\r\n    CHNL_DESC AS \"chnl_desc\",\r\n    SUB_CHNL_DESC AS \"sub_chnl_desc\",\r\n    CHNL_ATTR1_DESC AS \"chnl_attr1_desc\",\r\n    CHNL_ATTR2_DESC AS \"chnl_attr2_desc\",\r\n    SAP_STATE_CD AS \"sap_state_cd\",\r\n    SAP_SLS_ORG AS \"sap_sls_org\",\r\n    SAP_CMP_ID AS \"sap_cmp_id\",\r\n    SAP_CNTRY_CD AS \"sap_cntry_cd\",\r\n    SAP_CNTRY_NM AS \"sap_cntry_nm\",\r\n    SAP_ADDR AS \"sap_addr\",\r\n    SAP_REGION AS \"sap_region\",\r\n    SAP_CITY AS \"sap_city\",\r\n    SAP_POST_CD AS \"sap_post_cd\",\r\n    SAP_CHNL_CD AS \"sap_chnl_cd\",\r\n    SAP_CHNL_DESC AS \"sap_chnl_desc\",\r\n    SAP_SLS_OFFICE_CD AS \"sap_sls_office_cd\",\r\n    SAP_SLS_OFFICE_DESC AS \"sap_sls_office_desc\",\r\n    SAP_SLS_GRP_CD AS \"sap_sls_grp_cd\",\r\n    SAP_SLS_GRP_DESC AS \"sap_sls_grp_desc\",\r\n    SAP_CURR_CD AS \"sap_curr_cd\",\r\n    GCH_REGION AS \"gch_region\",\r\n    GCH_CLUSTER AS \"gch_cluster\",\r\n    GCH_SUBCLUSTER AS \"gch_subcluster\",\r\n    GCH_MARKET AS \"gch_market\",\r\n    GCH_RETAIL_BANNER AS \"gch_retail_banner\",\r\n    SKU AS \"sku\",\r\n    FRNCHSE_DESC AS \"frnchse_desc\",\r\n    BRND_DESC AS \"brnd_desc\",\r\n    VRNT_DESC AS \"vrnt_desc\",\r\n    PUTUP_DESC AS \"putup_desc\",\r\n    ITEM_DESC2 AS \"item_desc2\",\r\n    SKU_DESC AS \"sku_desc\",\r\n    SAP_MAT_TYPE_CD AS \"sap_mat_type_cd\",\r\n    SAP_MAT_TYPE_DESC AS \"sap_mat_type_desc\",\r\n    SAP_BASE_UOM_CD AS \"sap_base_uom_cd\",\r\n    SAP_PRCHSE_UOM_CD AS \"sap_prchse_uom_cd\",\r\n    SAP_PROD_SGMT_CD AS \"sap_prod_sgmt_cd\",\r\n    SAP_PROD_SGMT_DESC AS \"sap_prod_sgmt_desc\",\r\n    SAP_BASE_PROD_CD AS \"sap_base_prod_cd\",\r\n    SAP_BASE_PROD_DESC AS \"sap_base_prod_desc\",\r\n    SAP_MEGA_BRND_CD AS \"sap_mega_brnd_cd\",\r\n    SAP_MEGA_BRND_DESC AS \"sap_mega_brnd_desc\",\r\n    SAP_BRND_CD AS \"sap_brnd_cd\",\r\n    SAP_BRND_DESC AS \"sap_brnd_desc\",\r\n    SAP_VRNT_CD AS \"sap_vrnt_cd\",\r\n    SAP_VRNT_DESC AS \"sap_vrnt_desc\",\r\n    SAP_PUT_UP_CD AS \"sap_put_up_cd\",\r\n    SAP_PUT_UP_DESC AS \"sap_put_up_desc\",\r\n    SAP_GRP_FRNCHSE_CD AS \"sap_grp_frnchse_cd\",\r\n    SAP_GRP_FRNCHSE_DESC AS \"sap_grp_frnchse_desc\",\r\n    SAP_FRNCHSE_CD AS \"sap_frnchse_cd\",\r\n    SAP_FRNCHSE_DESC AS \"sap_frnchse_desc\",\r\n    SAP_PROD_FRNCHSE_CD AS \"sap_prod_frnchse_cd\",\r\n    SAP_PROD_FRNCHSE_DESC AS \"sap_prod_frnchse_desc\",\r\n    SAP_PROD_MJR_CD AS \"sap_prod_mjr_cd\",\r\n    SAP_PROD_MJR_DESC AS \"sap_prod_mjr_desc\",\r\n    SAP_PROD_MNR_CD AS \"sap_prod_mnr_cd\",\r\n    SAP_PROD_MNR_DESC AS \"sap_prod_mnr_desc\",\r\n    SAP_PROD_HIER_CD AS \"sap_prod_hier_cd\",\r\n    SAP_PROD_HIER_DESC AS \"sap_prod_hier_desc\",\r\n    GLOBAL_MAT_REGION AS \"global_mat_region\",\r\n    GLOBAL_PROD_FRANCHISE AS \"global_prod_franchise\",\r\n    GLOBAL_PROD_BRAND AS \"global_prod_brand\",\r\n    GLOBAL_PROD_VARIANT AS \"global_prod_variant\",\r\n    GLOBAL_PROD_PUT_UP_CD AS \"global_prod_put_up_cd\",\r\n    GLOBAL_PUT_UP_DESC AS \"global_put_up_desc\",\r\n    GLOBAL_PROD_SUB_BRAND AS \"global_prod_sub_brand\",\r\n    GLOBAL_PROD_NEED_STATE AS \"global_prod_need_state\",\r\n    GLOBAL_PROD_CATEGORY AS \"global_prod_category\",\r\n    GLOBAL_PROD_SUBCATEGORY AS \"global_prod_subcategory\",\r\n    GLOBAL_PROD_SEGMENT AS \"global_prod_segment\",\r\n    GLOBAL_PROD_SUBSEGMENT AS \"global_prod_subsegment\",\r\n    GLOBAL_PROD_SIZE AS \"global_prod_size\",\r\n    GLOBAL_PROD_SIZE_UOM AS \"global_prod_size_uom\",\r\n    FROM_CCY AS \"from_ccy\",\r\n    TO_CCY AS \"to_ccy\",\r\n    EXCH_RATE AS \"exch_rate\",\r\n    WH_ID AS \"wh_id\",\r\n    DOC_TYPE AS \"doc_type\",\r\n    DOC_TYPE_DESC AS \"doc_type_desc\",\r\n    BASE_SLS AS \"base_sls\",\r\n    SLS_QTY AS \"sls_qty\",\r\n    RET_QTY AS \"ret_qty\",\r\n    UOM AS \"uom\",\r\n    SLS_QTY_PC AS \"sls_qty_pc\",\r\n    RET_QTY_PC AS \"ret_qty_pc\",\r\n    BILL_QTY_PC AS \"bill_qty_pc\",\r\n    IN_TRANSIT_QTY AS \"in_transit_qty\",\r\n    MAT_LIST_PRICE AS \"mat_list_price\",\r\n    GRS_TRD_SLS AS \"grs_trd_sls\",\r\n    RET_VAL AS \"ret_val\",\r\n    TRD_DISCNT AS \"trd_discnt\",\r\n    TRD_SLS AS \"trd_sls\",\r\n    NET_TRD_SLS AS \"net_trd_sls\",\r\n    JJ_GRS_TRD_SLS AS \"jj_grs_trd_sls\",\r\n    JJ_RET_VAL AS \"jj_ret_val\",\r\n    JJ_TRD_SLS AS \"jj_trd_sls\",\r\n    JJ_NET_TRD_SLS AS \"jj_net_trd_sls\",\r\n    BILLING_GRS_TRD_SLS AS \"billing_grs_trd_sls\",\r\n    BILLING_SUBTOT2 AS \"billing_subtot2\",\r\n    BILLING_SUBTOT3 AS \"billing_subtot3\",\r\n    BILLING_SUBTOT4 AS \"billing_subtot4\",\r\n    BILLING_NET_AMT AS \"billing_net_amt\",\r\n    BILLING_EST_NTS AS \"billing_est_nts\",\r\n    BILLING_INVOICE_VAL AS \"billing_invoice_val\",\r\n    BILLING_GROSS_VAL AS \"billing_gross_val\",\r\n    IN_TRANSIT_VAL AS \"in_transit_val\",\r\n    TRGT_VAL AS \"trgt_val\",\r\n    WAREHSE_CD AS \"warehse_cd\",\r\n    END_STOCK_QTY AS \"end_stock_qty\",\r\n    END_STOCK_VAL_RAW AS \"end_stock_val_raw\",\r\n    END_STOCK_VAL AS \"end_stock_val\",\r\n    IS_NPI AS \"is_npi\",\r\n    NPI_STR_PERIOD AS \"npi_str_period\",\r\n    NPI_END_PERIOD AS \"npi_end_period\",\r\n    IS_REG AS \"is_reg\",\r\n    IS_PROMO AS \"is_promo\",\r\n    PROMO_STRT_PERIOD AS \"promo_strt_period\",\r\n    PROMO_END_PERIOD AS \"promo_end_period\",\r\n    IS_MCL AS \"is_mcl\",\r\n    IS_HERO AS \"is_hero\"\r\nFROM DEV_DNA_CORE.MYSEDW_INTEGRATION.EDW_MY_SISO_ANALYSIS;\r\n\r\n"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			}
		],
		"variables": {
			"countQueryRedshift": {
				"type": "String"
			},
			"countQuerySnowflake": {
				"type": "String"
			}
		},
		"folder": {
			"name": "Historical_Data_migration_redshift_snowflake"
		},
		"annotations": []
	}
}