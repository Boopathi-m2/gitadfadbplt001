create or replace TABLE PROD_DNA_CORE.PCFWKS_INTEGRATION.WKS_NATIONAL_ECOMM_DATA (
	PFC VARCHAR(20),
	SKUNAME VARCHAR(100),
	NEC1_DESC VARCHAR(100),
	NEC2_DESC VARCHAR(100),
	NEC3_DESC VARCHAR(100),
	BRAND VARCHAR(50),
	OWNER VARCHAR(50),
	MANUFACTURER VARCHAR(50),
	CATEGORY VARCHAR(50),
	MAT_YEAR VARCHAR(10),
	PERIODID VARCHAR(10),
	SALES_ONLINE VARCHAR(10),
	UNIT_ONLINE VARCHAR(10),
	WEEK_END VARCHAR(20),
	FILE_NAME VARCHAR(50)
);

create or replace TABLE PROD_DNA_CORE.ASPITG_INTEGRATION.ITG_WEEKLY_FORECAST (
	CREATE_DT TIMESTAMP_NTZ(9),
	CALMONTH NUMBER(6,0),
	CALQUART1 NUMBER(1,0),
	CALWEEK NUMBER(6,0),
	CALYEAR NUMBER(4,0),
	FISCVARNT VARCHAR(2),
	FISCPER NUMBER(7,0),
	FISCPER3 NUMBER(3,0),
	SALESORG VARCHAR(4),
	CO_CD VARCHAR(4),
	DISTR_CHAN VARCHAR(2),
	MAT_PLANT VARCHAR(18),
	VERSION VARCHAR(3),
	VTYPE NUMBER(3,0),
	JNJ_FISCAL_WEEK TIMESTAMP_NTZ(9),
	BASE_UOM VARCHAR(3),
	DOC_CURRCY VARCHAR(5),
	SNAP_DT TIMESTAMP_NTZ(9),
	SNAP_WK NUMBER(6,0),
	JNJ_FISCAL_YR NUMBER(6,0),
	PLANT VARCHAR(4),
	PROD_MNR VARCHAR(18),
	OPR_GRP VARCHAR(18),
	FRAN_GRP VARCHAR(18),
	FRANCHISE VARCHAR(18),
	PROD_FRAN VARCHAR(18),
	PROD_MJR VARCHAR(18),
	B1_MEGA_BRND VARCHAR(3),
	B2_BRND VARCHAR(3),
	B3_BASE_PROD VARCHAR(3),
	B4_VARIANT VARCHAR(3),
	B5_PUT_UP VARCHAR(3),
	MATERIAL VARCHAR(18),
	MERCIA_REFERENCE VARCHAR(5),
	MAT_SALES VARCHAR(18),
	SNAP_PER NUMBER(7,0),
	FISCYEAR NUMBER(4,0),
	ABLCMA NUMBER(17,3),
	BASE_FC NUMBER(17,3),
	CNBLEFCT NUMBER(17,3),
	TOT_FOR_VAL NUMBER(17,2),
	COR_DMD_HIST NUMBER(17,3),
	CPFR_FCST NUMBER(17,3),
	DPNDNT_HIS NUMBER(17,3),
	DMD_HIS NUMBER(17,3),
	HIS_SHIP NUMBER(17,3),
	MAPE001 NUMBER(17,3),
	MAPE002 NUMBER(17,3),
	MAPE003 NUMBER(17,3),
	MAPE004 NUMBER(17,3),
	MAPE005 NUMBER(17,3),
	NON_AF_FCST NUMBER(17,3),
	OTHMISI NUMBER(17,3),
	PRICE_CHNG NUMBER(17,3),
	PROMO NUMBER(17,3),
	FIN_PROP_FCT NUMBER(17,3),
	FIN_PROP_FAC_TBD NUMBER(17,3),
	PROP_FACT_TBD NUMBER(17,3),
	SAM_FREE_FCT NUMBER(17,3),
	TOT_MK_SLS_EVENTS NUMBER(17,3),
	TOT_FORECAST NUMBER(17,3),
	TOT_BAS_FCT NUMBER(17,3),
	NET_FCT NUMBER(17,3),
	TRD_INVC NUMBER(17,3),
	UNIT_PRC_SKU NUMBER(17,2),
	AUX02 NUMBER(17,3),
	PROP_FACT NUMBER(17,3),
	FIX_PROP_FACT NUMBER(17,3),
	HIS_SAL_ORD NUMBER(17,3),
	APO_COR_HIST NUMBER(17,3),
	PRD_DISC NUMBER(17,3),
	FINAL_STAT_FC NUMBER(17,3),
	SNCFCST NUMBER(17,3),
	TOTNOAFC NUMBER(17,3)
);

truncate table PCFWKS_INTEGRATION.WKS_NATIONAL_ECOMM_DATA;COPY INTO PCFWKS_INTEGRATION.WKS_NATIONAL_ECOMM_DATA FROM '@UTILITY_RAW.PROD_CORE_STAGE_S3/AU_WKS_WKS_NATIONAL_ECOMM_DATA/' FILE_FORMAT = 'UTILITY_RAW.PROD_CORE_CSV_FILEFORMAT' ;

truncate table ASPITG_INTEGRATION.ITG_WEEKLY_FORECAST;COPY INTO ASPITG_INTEGRATION.ITG_WEEKLY_FORECAST FROM '@UTILITY_RAW.PROD_CORE_STAGE_S3/RG_ITG_ITG_WEEKLY_FORECAST/' FILE_FORMAT = 'UTILITY_RAW.PROD_CORE_CSV_FILEFORMAT';
