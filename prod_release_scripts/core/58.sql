USE SCHEMA VNMWKS_INTEGRATION;

create or replace TABLE WKS_VIETNAM_SISO_PROPAGATE_FINAL (
	SAP_PARENT_CUSTOMER_KEY VARCHAR(12),
	SAP_PARENT_CUSTOMER_DESC VARCHAR(50),
	MONTH VARCHAR(23),
	MATL_NUM VARCHAR(50),
	SO_QTY NUMBER(38,4),
	SO_VALUE NUMBER(38,11),
	INV_QTY NUMBER(38,2),
	INV_VALUE NUMBER(38,10),
	SELL_IN_QTY NUMBER(38,4),
	SELL_IN_VALUE NUMBER(38,4),
	LAST_3MONTHS_SO NUMBER(38,4),
	LAST_6MONTHS_SO NUMBER(38,4),
	LAST_12MONTHS_SO NUMBER(38,4),
	LAST_3MONTHS_SO_VALUE NUMBER(38,11),
	LAST_6MONTHS_SO_VALUE NUMBER(38,11),
	LAST_12MONTHS_SO_VALUE NUMBER(38,11),
	LAST_36MONTHS_SO_VALUE NUMBER(38,11),
	PROPAGATE_FLAG VARCHAR(1),
	PROPAGATE_FROM NUMBER(18,0),
	REASON VARCHAR(100),
	REPLICATED_FLAG VARCHAR(1),
	EXISTING_SO_QTY NUMBER(38,5),
	EXISTING_SO_VALUE NUMBER(38,5),
	EXISTING_INV_QTY NUMBER(38,5),
	EXISTING_INV_VALUE NUMBER(38,5),
	EXISTING_SELL_IN_QTY NUMBER(38,5),
	EXISTING_SELL_IN_VALUE NUMBER(38,5),
	EXISTING_LAST_3MONTHS_SO NUMBER(38,5),
	EXISTING_LAST_6MONTHS_SO NUMBER(38,5),
	EXISTING_LAST_12MONTHS_SO NUMBER(38,5),
	EXISTING_LAST_3MONTHS_SO_VALUE NUMBER(38,5),
	EXISTING_LAST_6MONTHS_SO_VALUE NUMBER(38,5),
	EXISTING_LAST_12MONTHS_SO_VALUE NUMBER(38,5)
);
create or replace TABLE WKS_VIETNAM_SISO_PROPAGATE_TO_DETAILS (
	SAP_PARENT_CUSTOMER_KEY VARCHAR(12),
	SAP_PARENT_CUSTOMER_DESC VARCHAR(50),
	MONTH VARCHAR(23),
	MATL_NUM VARCHAR(50),
	SO_QTY NUMBER(38,4),
	SO_VALUE NUMBER(38,11),
	INV_QTY NUMBER(38,2),
	INV_VALUE NUMBER(38,10),
	SELL_IN_QTY NUMBER(38,4),
	SELL_IN_VALUE NUMBER(38,4),
	LAST_3MONTHS_SO NUMBER(38,4),
	LAST_6MONTHS_SO NUMBER(38,4),
	LAST_12MONTHS_SO NUMBER(38,4),
	LAST_3MONTHS_SO_VALUE NUMBER(38,11),
	LAST_6MONTHS_SO_VALUE NUMBER(38,11),
	LAST_12MONTHS_SO_VALUE NUMBER(38,11),
	LAST_36MONTHS_SO_VALUE NUMBER(38,11),
	PROPAGATION_FLAG VARCHAR(1),
	PROPAGATE_FROM VARCHAR(23),
	REASON VARCHAR(29),
	REPLICATED_FLAG VARCHAR(1)
);
create or replace TABLE WKS_VIETNAM_SISO_PROPAGATE_TO_EXISTING_DTLS (
	SAP_PARENT_CUSTOMER_KEY VARCHAR(12),
	SAP_PARENT_CUSTOMER_DESC VARCHAR(50),
	MONTH VARCHAR(23),
	MATL_NUM VARCHAR(50),
	SO_QTY NUMBER(38,4),
	SO_VALUE NUMBER(38,11),
	INV_QTY NUMBER(38,2),
	INV_VALUE NUMBER(38,10),
	SELL_IN_QTY NUMBER(38,4),
	SELL_IN_VALUE NUMBER(38,4),
	LAST_3MONTHS_SO NUMBER(38,4),
	LAST_6MONTHS_SO NUMBER(38,4),
	LAST_12MONTHS_SO NUMBER(38,4),
	LAST_3MONTHS_SO_VALUE NUMBER(38,11),
	LAST_6MONTHS_SO_VALUE NUMBER(38,11),
	LAST_12MONTHS_SO_VALUE NUMBER(38,11),
	LAST_36MONTHS_SO_VALUE NUMBER(38,11),
	PROPAGATE_FROM VARCHAR(23),
	REPLICATED_FLAG VARCHAR(1)
);

create or replace TABLE WKS_VIETNAM_BASE (
	MONTH VARCHAR(23),
	MATL_NUM VARCHAR(50),
	SAP_PARENT_CUSTOMER_KEY VARCHAR(12),
	SAP_PARENT_CUSTOMER_DESC VARCHAR(50),
	SELL_IN_QTY NUMBER(38,4),
	SELL_IN_VALUE NUMBER(38,4),
	INV_QTY NUMBER(38,2),
	INV_VALUE NUMBER(38,10),
	SO_QTY NUMBER(38,4),
	SO_VALUE NUMBER(38,11)
);
create or replace TABLE WKS_VIETNAM_BASE_DETAIL (
	SAP_PARENT_CUSTOMER_KEY VARCHAR(12),
	SAP_PARENT_CUSTOMER_DESC VARCHAR(50),
	MATL_NUM VARCHAR(50),
	MONTH VARCHAR(23),
	BASE_MATL_NUM VARCHAR(50),
	REPLICATED_FLAG VARCHAR(1),
	SO_QTY NUMBER(38,4),
	SO_VALUE NUMBER(38,11),
	INV_QTY NUMBER(38,2),
	INV_VALUE NUMBER(38,10),
	SELL_IN_QTY NUMBER(38,4),
	SELL_IN_VALUE NUMBER(38,4),
	LAST_3MONTHS_SO NUMBER(38,4),
	LAST_6MONTHS_SO NUMBER(38,4),
	LAST_12MONTHS_SO NUMBER(38,4),
	LAST_3MONTHS_SO_VALUE NUMBER(38,11),
	LAST_6MONTHS_SO_VALUE NUMBER(38,11),
	LAST_12MONTHS_SO_VALUE NUMBER(38,11),
	LAST_36MONTHS_SO_VALUE NUMBER(38,11)
);
create or replace TABLE WKS_VIETNAM_INVENTORY_HEALTHY_UNHEALTHY_ANALYSIS (
	MONTH VARCHAR(23),
	BRAND VARCHAR(30),
	VARIANT VARCHAR(100),
	SEGMENT VARCHAR(50),
	PROD_CATEGORY VARCHAR(50),
	PKA_SIZE_DESC VARCHAR(30),
	PKA_PRODUCT_KEY VARCHAR(68),
	SAP_PARENT_CUSTOMER_KEY VARCHAR(12),
	LAST_3MONTHS_SO_VAL NUMBER(38,11),
	LAST_6MONTHS_SO_VAL NUMBER(38,11),
	LAST_12MONTHS_SO_VAL NUMBER(38,11),
	LAST_36MONTHS_SO_VAL NUMBER(38,11),
	HEALTHY_INVENTORY VARCHAR(1)
);
create or replace TABLE WKS_VIETNAM_INVENTORY_HEALTH_ANALYSIS_PROPAGATION_FINAL (
	YEAR NUMBER(18,0),
	QRTR_NO VARCHAR(11),
	MNTH_ID VARCHAR(23),
	MNTH_NO NUMBER(18,0),
	CNTRY_NM VARCHAR(7),
	DSTRBTR_GRP_CD VARCHAR(12),
	DSTRBTR_GRP_CD_NAME VARCHAR(2),
	GLOBAL_PROD_FRANCHISE VARCHAR(30),
	GLOBAL_PROD_BRAND VARCHAR(30),
	GLOBAL_PROD_SUB_BRAND VARCHAR(100),
	GLOBAL_PROD_VARIANT VARCHAR(100),
	GLOBAL_PROD_SEGMENT VARCHAR(50),
	GLOBAL_PROD_SUBSEGMENT VARCHAR(100),
	GLOBAL_PROD_CATEGORY VARCHAR(50),
	GLOBAL_PROD_SUBCATEGORY VARCHAR(50),
	GLOBAL_PUT_UP_DESC VARCHAR(30),
	SKU_CD VARCHAR(40),
	SKU_DESCRIPTION VARCHAR(100),
	PKA_PRODUCT_KEY VARCHAR(68),
	PKA_PRODUCT_KEY_DESCRIPTION VARCHAR(255),
	PRODUCT_KEY VARCHAR(68),
	PRODUCT_KEY_DESCRIPTION VARCHAR(255),
	FROM_CCY VARCHAR(3),
	TO_CCY VARCHAR(3),
	EXCH_RATE NUMBER(20,10),
	SAP_PRNT_CUST_KEY VARCHAR(12),
	SAP_PRNT_CUST_DESC VARCHAR(50),
	SAP_CUST_CHNL_KEY VARCHAR(12),
	SAP_CUST_CHNL_DESC VARCHAR(50),
	SAP_CUST_SUB_CHNL_KEY VARCHAR(12),
	SAP_SUB_CHNL_DESC VARCHAR(50),
	SAP_GO_TO_MDL_KEY VARCHAR(12),
	SAP_GO_TO_MDL_DESC VARCHAR(50),
	SAP_BNR_KEY VARCHAR(12),
	SAP_BNR_DESC VARCHAR(50),
	SAP_BNR_FRMT_KEY VARCHAR(12),
	SAP_BNR_FRMT_DESC VARCHAR(50),
	RETAIL_ENV VARCHAR(50),
	REGION VARCHAR(20),
	ZONE_OR_AREA VARCHAR(100),
	SI_SLS_QTY NUMBER(38,5),
	SI_GTS_VAL NUMBER(38,5),
	SI_GTS_VAL_USD NUMBER(38,5),
	INVENTORY_QUANTITY NUMBER(38,5),
	INVENTORY_VAL NUMBER(38,5),
	INVENTORY_VAL_USD NUMBER(38,5),
	SO_SLS_QTY NUMBER(38,5),
	SO_TRD_SLS NUMBER(38,5),
	SO_TRD_SLS_USD NUMBER(38,5),
	SI_ALL_DB_VAL NUMBER(38,5),
	SI_ALL_DB_VAL_USD NUMBER(38,5),
	SI_INV_DB_VAL NUMBER(38,5),
	SI_INV_DB_VAL_USD NUMBER(38,5),
	LAST_3MONTHS_SO_QTY NUMBER(38,4),
	LAST_6MONTHS_SO_QTY NUMBER(38,4),
	LAST_12MONTHS_SO_QTY NUMBER(38,4),
	LAST_3MONTHS_SO_VAL NUMBER(38,11),
	LAST_3MONTHS_SO_VAL_USD NUMBER(38,5),
	LAST_6MONTHS_SO_VAL NUMBER(38,11),
	LAST_6MONTHS_SO_VAL_USD NUMBER(38,5),
	LAST_12MONTHS_SO_VAL NUMBER(38,11),
	LAST_12MONTHS_SO_VAL_USD NUMBER(38,5),
	PROPAGATE_FLAG VARCHAR(1),
	PROPAGATE_FROM NUMBER(18,0),
	REASON VARCHAR(100),
	LAST_36MONTHS_SO_VAL NUMBER(38,11),
	HEALTHY_INVENTORY VARCHAR(1),
	MIN_DATE DATE,
	DIFF_WEEKS NUMBER(38,0),
	L12M_WEEKS NUMBER(38,0),
	L6M_WEEKS NUMBER(38,0),
	L3M_WEEKS NUMBER(38,0),
	L12M_WEEKS_AVG_SALES NUMBER(38,11),
	L6M_WEEKS_AVG_SALES NUMBER(38,11),
	L3M_WEEKS_AVG_SALES NUMBER(38,11),
	L12M_WEEKS_AVG_SALES_USD NUMBER(38,5),
	L6M_WEEKS_AVG_SALES_USD NUMBER(38,5),
	L3M_WEEKS_AVG_SALES_USD NUMBER(38,5),
	L12M_WEEKS_AVG_SALES_QTY NUMBER(38,4),
	L6M_WEEKS_AVG_SALES_QTY NUMBER(38,4),
	L3M_WEEKS_AVG_SALES_QTY NUMBER(38,4)
);
create or replace TABLE WKS_VIETNAM_LASTNMONTHS (
	SAP_PARENT_CUSTOMER_KEY VARCHAR(12),
	SAP_PARENT_CUSTOMER_DESC VARCHAR(50),
	MATL_NUM VARCHAR(50),
	MONTH VARCHAR(23),
	SO_QTY NUMBER(38,4),
	SO_VALUE NUMBER(38,11),
	INV_QTY NUMBER(38,2),
	INV_VALUE NUMBER(38,10),
	SELL_IN_QTY NUMBER(38,4),
	SELL_IN_VALUE NUMBER(38,4),
	LAST_3MONTHS_SO NUMBER(38,4),
	LAST_3MONTHS_SO_VALUE NUMBER(38,11),
	LAST_6MONTHS_SO NUMBER(38,4),
	LAST_6MONTHS_SO_VALUE NUMBER(38,11),
	LAST_12MONTHS_SO NUMBER(38,4),
	LAST_12MONTHS_SO_VALUE NUMBER(38,11),
	LAST_36MONTHS_SO NUMBER(38,4),
	LAST_36MONTHS_SO_VALUE NUMBER(38,11)
);

create or replace TABLE WKS_VIETNAM_ALLMONTHS_BASE (
	SAP_PARENT_CUSTOMER_KEY VARCHAR(12),
	SAP_PARENT_CUSTOMER_DESC VARCHAR(50),
	MATL_NUM VARCHAR(50),
	MONTH VARCHAR(23),
	SO_QTY NUMBER(38,4),
	SO_VALUE NUMBER(38,11),
	INV_QTY NUMBER(38,2),
	INV_VALUE NUMBER(38,10),
	SELL_IN_QTY NUMBER(38,4),
	SELL_IN_VALUE NUMBER(38,4)
);

create or replace TABLE WKS_VIETNAM_SELLOUT_FOR_INV_ANALYSIS (
	MIN_DATE DATE,
	BRAND VARCHAR(30),
	VARIANT VARCHAR(100),
	SEGMENT VARCHAR(50),
	PROD_CATEGORY VARCHAR(50),
	PKA_SIZE_DESC VARCHAR(30),
	PKA_PRODUCT_KEY VARCHAR(68),
	SAP_PARENT_CUSTOMER_KEY VARCHAR(12)
);

create or replace TABLE VIETNAM_INVENTORY_HEALTH_ANALYSIS_PROPAGATION (
	YEAR NUMBER(18,0),
	QRTR_NO VARCHAR(11),
	MNTH_ID VARCHAR(23),
	MNTH_NO NUMBER(18,0),
	CNTRY_NM VARCHAR(7),
	DSTRBTR_GRP_CD VARCHAR(12),
	DSTRBTR_GRP_CD_NAME VARCHAR(2),
	GLOBAL_PROD_FRANCHISE VARCHAR(30),
	GLOBAL_PROD_BRAND VARCHAR(30),
	GLOBAL_PROD_SUB_BRAND VARCHAR(100),
	GLOBAL_PROD_VARIANT VARCHAR(100),
	GLOBAL_PROD_SEGMENT VARCHAR(50),
	GLOBAL_PROD_SUBSEGMENT VARCHAR(100),
	GLOBAL_PROD_CATEGORY VARCHAR(50),
	GLOBAL_PROD_SUBCATEGORY VARCHAR(50),
	GLOBAL_PUT_UP_DESC VARCHAR(30),
	SKU_CD VARCHAR(40),
	SKU_DESCRIPTION VARCHAR(100),
	PKA_PRODUCT_KEY VARCHAR(68),
	PKA_PRODUCT_KEY_DESCRIPTION VARCHAR(255),
	PRODUCT_KEY VARCHAR(68),
	PRODUCT_KEY_DESCRIPTION VARCHAR(255),
	FROM_CCY VARCHAR(3),
	TO_CCY VARCHAR(3),
	EXCH_RATE NUMBER(20,10),
	SAP_PRNT_CUST_KEY VARCHAR(12),
	SAP_PRNT_CUST_DESC VARCHAR(50),
	SAP_CUST_CHNL_KEY VARCHAR(12),
	SAP_CUST_CHNL_DESC VARCHAR(50),
	SAP_CUST_SUB_CHNL_KEY VARCHAR(12),
	SAP_SUB_CHNL_DESC VARCHAR(50),
	SAP_GO_TO_MDL_KEY VARCHAR(12),
	SAP_GO_TO_MDL_DESC VARCHAR(50),
	SAP_BNR_KEY VARCHAR(12),
	SAP_BNR_DESC VARCHAR(50),
	SAP_BNR_FRMT_KEY VARCHAR(12),
	SAP_BNR_FRMT_DESC VARCHAR(50),
	RETAIL_ENV VARCHAR(50),
	REGION VARCHAR(20),
	ZONE_OR_AREA VARCHAR(100),
	SI_SLS_QTY NUMBER(38,5),
	SI_GTS_VAL NUMBER(38,5),
	SI_GTS_VAL_USD NUMBER(38,5),
	INVENTORY_QUANTITY NUMBER(38,5),
	INVENTORY_VAL NUMBER(38,5),
	INVENTORY_VAL_USD NUMBER(38,5),
	SO_SLS_QTY NUMBER(38,5),
	SO_TRD_SLS NUMBER(38,5),
	SO_TRD_SLS_USD NUMBER(38,5),
	SI_ALL_DB_VAL NUMBER(38,5),
	SI_ALL_DB_VAL_USD NUMBER(38,5),
	SI_INV_DB_VAL NUMBER(38,5),
	SI_INV_DB_VAL_USD NUMBER(38,5),
	LAST_3MONTHS_SO_QTY NUMBER(38,4),
	LAST_6MONTHS_SO_QTY NUMBER(38,4),
	LAST_12MONTHS_SO_QTY NUMBER(38,4),
	LAST_3MONTHS_SO_VAL NUMBER(38,11),
	LAST_3MONTHS_SO_VAL_USD NUMBER(38,5),
	LAST_6MONTHS_SO_VAL NUMBER(38,11),
	LAST_6MONTHS_SO_VAL_USD NUMBER(38,5),
	LAST_12MONTHS_SO_VAL NUMBER(38,11),
	LAST_12MONTHS_SO_VAL_USD NUMBER(38,5),
	PROPAGATE_FLAG VARCHAR(1),
	PROPAGATE_FROM NUMBER(18,0),
	REASON VARCHAR(100),
	LAST_36MONTHS_SO_VAL NUMBER(38,11)
);
create or replace TABLE VIETNAM_INVENTORY_HEALTH_ANALYSIS_PROPAGATION_PRESTEP (
	YEAR NUMBER(18,0),
	QRTR_NO VARCHAR(11),
	MNTH_ID VARCHAR(23),
	MNTH_NO NUMBER(18,0),
	CNTRY_NM VARCHAR(7),
	DSTRBTR_GRP_CD VARCHAR(12),
	DSTRBTR_GRP_CD_NAME VARCHAR(2),
	GLOBAL_PROD_FRANCHISE VARCHAR(30),
	GLOBAL_PROD_BRAND VARCHAR(30),
	GLOBAL_PROD_SUB_BRAND VARCHAR(100),
	GLOBAL_PROD_VARIANT VARCHAR(100),
	GLOBAL_PROD_SEGMENT VARCHAR(50),
	GLOBAL_PROD_SUBSEGMENT VARCHAR(100),
	GLOBAL_PROD_CATEGORY VARCHAR(50),
	GLOBAL_PROD_SUBCATEGORY VARCHAR(50),
	GLOBAL_PUT_UP_DESC VARCHAR(30),
	SKU_CD VARCHAR(40),
	SKU_DESCRIPTION VARCHAR(100),
	PKA_PRODUCT_KEY VARCHAR(68),
	PKA_PRODUCT_KEY_DESCRIPTION VARCHAR(255),
	PRODUCT_KEY VARCHAR(68),
	PRODUCT_KEY_DESCRIPTION VARCHAR(255),
	FROM_CCY VARCHAR(3),
	TO_CCY VARCHAR(3),
	EXCH_RATE NUMBER(20,10),
	SAP_PRNT_CUST_KEY VARCHAR(12),
	SAP_PRNT_CUST_DESC VARCHAR(50),
	SAP_CUST_CHNL_KEY VARCHAR(12),
	SAP_CUST_CHNL_DESC VARCHAR(50),
	SAP_CUST_SUB_CHNL_KEY VARCHAR(12),
	SAP_SUB_CHNL_DESC VARCHAR(50),
	SAP_GO_TO_MDL_KEY VARCHAR(12),
	SAP_GO_TO_MDL_DESC VARCHAR(50),
	SAP_BNR_KEY VARCHAR(12),
	SAP_BNR_DESC VARCHAR(50),
	SAP_BNR_FRMT_KEY VARCHAR(12),
	SAP_BNR_FRMT_DESC VARCHAR(50),
	RETAIL_ENV VARCHAR(50),
	REGION VARCHAR(20),
	ZONE_OR_AREA VARCHAR(100),
	SI_SLS_QTY NUMBER(38,5),
	SI_GTS_VAL NUMBER(38,5),
	SI_GTS_VAL_USD NUMBER(38,5),
	INVENTORY_QUANTITY NUMBER(38,5),
	INVENTORY_VAL NUMBER(38,5),
	INVENTORY_VAL_USD NUMBER(38,5),
	SO_SLS_QTY NUMBER(38,5),
	SO_TRD_SLS NUMBER(38,5),
	SO_TRD_SLS_USD NUMBER(38,5),
	LAST_3MONTHS_SO_QTY NUMBER(38,4),
	LAST_6MONTHS_SO_QTY NUMBER(38,4),
	LAST_12MONTHS_SO_QTY NUMBER(38,4),
	LAST_3MONTHS_SO_VAL NUMBER(38,11),
	LAST_3MONTHS_SO_VAL_USD NUMBER(38,5),
	LAST_6MONTHS_SO_VAL NUMBER(38,11),
	LAST_6MONTHS_SO_VAL_USD NUMBER(38,5),
	LAST_12MONTHS_SO_VAL NUMBER(38,11),
	LAST_12MONTHS_SO_VAL_USD NUMBER(38,5),
	PROPAGATE_FLAG VARCHAR(1),
	PROPAGATE_FROM NUMBER(18,0),
	REASON VARCHAR(100),
	LAST_36MONTHS_SO_VAL NUMBER(38,11)
);
create or replace TABLE VIETNAM_PROPAGATE_FROM_TO (
	SAP_PARENT_CUSTOMER_KEY VARCHAR(12),
	SAP_PARENT_CUSTOMER_DESC VARCHAR(50),
	LATEST_MONTH VARCHAR(23),
	PROPAGATE_TO VARCHAR(23),
	PROPAGATE_FROM VARCHAR(23),
	SO_QTY NUMBER(38,4),
	INV_QTY NUMBER(38,2),
	DIFF_MONTH NUMBER(38,0),
	REASON VARCHAR(29)
);
create or replace TABLE VIETNAM_PROPAGATE_TO cluster by (sap_parent_customer_key)(
	SAP_PARENT_CUSTOMER_KEY VARCHAR(12),
	SAP_PARENT_CUSTOMER_DESC VARCHAR(50),
	MONTH VARCHAR(23),
	SO_QTY NUMBER(38,4),
	SO_VALUE NUMBER(38,11),
	INV_QTY NUMBER(38,2),
	INV_VALUE NUMBER(38,10),
	PROPAGATE_FLAG VARCHAR(1),
	LATEST_MONTH VARCHAR(23)
);
