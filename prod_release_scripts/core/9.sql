create or replace TABLE ASPITG_INTEGRATION.ITG_COPA_TRANS (
	REQUEST_NUMBER VARCHAR(100) NOT NULL,
	DATA_PACKET VARCHAR(50) NOT NULL,
	DATA_RECORD VARCHAR(100) NOT NULL,
	CO_CD VARCHAR(4),
	CNTL_AREA VARCHAR(4),
	PRFT_CTR VARCHAR(10),
	SLS_ORG VARCHAR(4),
	MATL VARCHAR(18),
	CUST_NUM VARCHAR(10),
	DIV VARCHAR(2),
	PLNT VARCHAR(4),
	CHRT_ACCT VARCHAR(4),
	ACCT_NUM VARCHAR(10),
	DSTR_CHNL VARCHAR(2),
	FISC_YR_VAR VARCHAR(2),
	VERS VARCHAR(3),
	BW_DELTA_UPD_MODE VARCHAR(1),
	BILL_TYP VARCHAR(4),
	SLS_OFF VARCHAR(4),
	CNTRY_KEY VARCHAR(3),
	SLS_DEAL VARCHAR(10),
	SLS_GRP VARCHAR(3),
	SLS_EMP_HIST NUMBER(18,0),
	SLS_DIST VARCHAR(6),
	CUST_GRP VARCHAR(2),
	CUST_SLS VARCHAR(10),
	BUSS_AREA VARCHAR(4),
	VAL_TYPE_RPT NUMBER(18,0),
	MERCIA_REF VARCHAR(5),
	CALN_DAY VARCHAR(20),
	CALN_YR_MO NUMBER(18,0),
	FISC_YR NUMBER(18,0),
	PSTNG_PER NUMBER(18,0),
	FISC_YR_PER NUMBER(18,0),
	B3_BASE_PROD VARCHAR(3),
	B4_VAR VARCHAR(3),
	B5_PUT_UP VARCHAR(3),
	B1_MEGA_BRND VARCHAR(3),
	B2_BRND VARCHAR(3),
	REG VARCHAR(3),
	PROD_MINOR VARCHAR(18),
	PROD_MAJ VARCHAR(18),
	PROD_FRAN VARCHAR(18),
	FRAN VARCHAR(18),
	GRAN_GRP VARCHAR(18),
	OPER_GRP VARCHAR(18),
	SLS_PRSN_RESP VARCHAR(30),
	MATL_SLS VARCHAR(18),
	PROD_HIER VARCHAR(18),
	MGMT_ENTITY VARCHAR(6),
	FX_AMT_CNTL_AREA_CRNCY NUMBER(20,5),
	AMT_CNTL_AREA_CRNCY NUMBER(20,5),
	CRNCY_KEY VARCHAR(5),
	AMT_OBJ_CRNCY NUMBER(20,5),
	OBJ_CRNCY_CO_OBJ VARCHAR(5),
	GRS_AMT_TRANS_CRNCY NUMBER(20,5),
	CRNCY_KEY_TRANS_CRNCY VARCHAR(5),
	QTY NUMBER(20,5),
	UOM VARCHAR(20),
	SLS_VOL NUMBER(20,5),
	UN_SLS_VOL VARCHAR(20),
	CRT_DTTM TIMESTAMP_NTZ(9),
	UPDT_DTTM TIMESTAMP_NTZ(9),
	primary key (REQUEST_NUMBER, DATA_PACKET, DATA_RECORD)
);

COPY INTO ASPITG_INTEGRATION.ITG_COPA_TRANS FROM '@UTILITY_RAW.PROD_CORE_STAGE_S3/RG_ITG_ITG_COPA_TRANS/' FILE_FORMAT = 'UTILITY_RAW.PROD_CORE_CSV_FILEFORMAT' ;

alter table aspitg_integration.itg_copa_trans add column file_name varchar(255);

update aspitg_integration.itg_copa_trans set file_name='No file name in Legacy System' where file_name is null;
